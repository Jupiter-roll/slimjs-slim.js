<script type="text/javascript">

    +(function() {

        document.registerElement('s-repeat', class SlimRepeat extends SlimBaseElement {

            onAdded() {
                this.sourceData = this.parentNode.parentNode[this.getAttribute('source')]
            }

            _renderCycle() {
                super._renderCycle(true)
            }

            set sourceData(data) {
                if (!data) return
                this._sourceData = data
                this.update()
            }

            get sourceData() {
                return this._sourceData || []
            }

            update() {
                this.innerHTML = ''
                for (let dataItem of this.sourceData) {
                    for (let child of this.__bindingTree.children) {
                        let node = document.importNode(child, false)
                        node.data = dataItem
                        for (let prop in dataItem) {
                            node[prop] = dataItem[prop]
                            if (!(typeof dataItem[prop] === "function") && !(typeof dataItem[prop] === "object")) {
                                node.setAttribute(prop, dataItem[prop])
                            }
                        }
                        this.appendChild(node)
                        node.update()
                    }
                }
            }
        })
    })() 
</script>