<template id="list-options-template">
    <ul id="items"></ul>
    <style>
        #list-options-template {
            display: inline-flex;
        }
        .vertical {
            flex-direction: column
        }
        .horizontal {
            flex-direction: row;
        }
    </style>
</template>    

<script>  
    (function(document) {
        const ownerDoc = document.currentScript.ownerDocument
        document.registerElement('list-options', class extends SlimElement {
            _render() {
                super._render()
                let content = this.shadowRoot.querySelector('#items')
                let items = this.querySelectorAll('item')
                content.innerHTML = ''
                if (this.getAttribute('layout')) {
                    content.className = this.getAttribute('layout') 
                }
                for (let item of items) {
                    let e = ownerDoc.createElement('li')
                    e.innerText = item.getAttribute('label')
                    e.setAttribute('value', item.getAttribute('value'))
                    if (item.getAttribute('value') === this.getAttribute('selected')) {
                        e.className = 'item selected'
                    } else {
                        e.className = 'item'
                    }
                    e.onclick = () => {
                        this.selectItem(item.getAttribute('value'))
                    }
                    content.appendChild(e)
                }
            }
            selectItem(value) {
                if (value !== this.getAttribute('selected')) {
                    this.setAttribute('selected', value)
                    this._render()
                    this.dispatchEvent(new Event('change'))
                }
            }
            _onAttributeChanged() {
                this._render()
            }
            _onAdded() {
                this._render()
            }
            _onRemoved() {
                this._render()
            }
            _onCreated() {
                super._onCreated()
                let shadow = this.createShadowRoot()
                let template = ownerDoc.querySelector('#list-options-template')
                shadow.appendChild(template.content.cloneNode(true))
                this._render()
            }
        })
    }(document))
</script>