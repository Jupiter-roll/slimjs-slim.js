<script>

;(function(){


    Slim('kanban-item', class extends SlimBaseElement {

        get template() {
            return `
<div>
    <div class="title"><span bind>[[data.title]]</span></div>
    <div><input class="toggle" type="button" value="[getToggleText(open)]" /></div>
    <div class="description" bind>[[data.description]]</div>
</div>`
        }

        beforeRender() {
            this.open = true;
        }

        getToggleText(value) {
            if (value) {
                return '-'
            }
            return '+'
        }

        afterRender() {
            $(this).draggable({
                handle: '.title',
                scroll: 'false',
                start: () => {
                    this.open = false
                    this.update()
                },
                snap: 'kanban-column',
                revert: 'invalid',
                revertDuration: 100,
                connectWith: 'kanban-column'
            })
            $(this.find('.toggle')).click( () => {
                this.open = !this.open
                this.update()
            })
            this.update()
        }

        update() {
            super.update()
            if (this.open) {
                $(this.find('.description')).show()
            } else {
                $(this.find('.description')).hide()
            }
        }

    })



})()


</script>

<style>
    kanban-item {
        display: inline-flex;
        background: white;
        width: 100%;
        padding: 0.5em;
        border-radius: 1em;
        margin-bottom: 1em;
        justify-content: center;
    }

    kanban-item:last-child {
        margin-bottom: 0;
    }

    kanban-item div {
        width: 100%;
    }

    kanban-item .title {
        font-family: "Catamaran", Sans-serif;
        font-weight: normal;
        font-size: 1.3em;
        width: 100%;
        border-bottom: 1px solid black;
        display: inline-flex;
    }
</style>